var{app:r,BrowserWindow:a,ipcMain:c}=require("electron"),d=require("path"),t=null,s=process.env.GEMINI_API_KEY;s||console.warn("Warning: GEMINI_API_KEY not set. AI features will not work.");c.handle("genai-ask",async(n,l)=>{if(!t){let{GoogleGenAI:o}=require("@google/genai");t=new o({apiKey:s})}try{return(await t.models.generateContent({model:"gemini-2.0-flash-001",contents:[{role:"user",parts:[{text:l}]}]})).candidates?.[0]?.content?.parts?.[0]?.text||"[AI ERROR] Empty response from Gemini."}catch(o){console.error("AI Error:",o);let e=o.message.toLowerCase();return e.includes("overloaded")?"AI service overloaded. Try again later.":e.includes("quota")||e.includes("limit")?"API quota or usage limit reached.":e.includes("network")||e.includes("econnrefused")?"Network error: Check your connection.":e.includes("invalid api key")||e.includes("authentication")?"Authentication error: Check your API key.":`AI Error: ${o.message}`}});function i(){let n=new a({width:1e3,height:700,useContentSize:!0,show:!1,webPreferences:{contextIsolation:!0,nodeIntegration:!1,preload:d.join(__dirname,"preload.js")}});n.webContents.openDevTools(),n.once("ready-to-show",()=>n.show()),n.loadFile("index.html")}r.whenReady().then(()=>{i(),r.on("activate",()=>{a.getAllWindows().length===0&&i()})});r.on("window-all-closed",()=>{process.platform!=="darwin"&&r.quit()});
